- # 项目简介

  本项目基于Shapley值，对于客户端执行图像分类任务，设计有效的联邦学习奖励机制算法，并对算法进行了一定的优化。

- # 功能特性

  本联邦学习项目，对于客户端执行简单的图像分类任务，以博弈论中Shapley值，评估客户端对全局模型的贡献值，设计有效的联邦学习奖励机制算法，并在MNIST，Adult数据上，针对客户数据集大小不均衡和数据集类不均衡两种实验设置，进行了一定的实验。由于随着客户端数量的增多，真实Shapley值的计算复杂度是指数级增长，基于截断蒙特卡洛的方法，对实现真实Shapley值进行一个估计，并完成实验验证。

- # 环境依赖

  `conda env create -f env.yml`

- # 训练

  `python main.py or python.test.py`

  实验的参数在`main.py` or `test.py`文件中指定。

  可以更改`arguments.py`默认参数的存储位置。

  `python examine_results.py --experiment_dir <experiment_dir>`

  运行上述命令来获得相应的准确性和公平性结果，以及显示收敛行为的数字

- # 训练结果

  ## Imbalance data

  ### Accuracy

  |                | **P3_0.1** | **P3_1.0** | **P6_0.1** | **P6_1.0** | **P9_0.1** | **P9_1.0** |
  | -------------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
  | **Fedavg**     | 0.8956     | 0.8975     | 0.9145     | 0.9145     | 0.9227     | 0.9227     |
  | **DSSGD**      | 0.8914     | 0.8943     | 0.7897     | 0.8505     | 0.7218     | 0.8092     |
  | **Standalone** | 0.8826     | 0.8634     | 0.8888     | 0.8888     | 0.8881     | 0.8881     |
  | **CFFL**       | **0.9065** | 0.9072     | **0.9214** | 0.9274     | **0.9239** | **0.9337** |
  | **CFFL_P**     | 0.9045     | **0.9088** | 0.9199     | **0.9278** | 0.9236     | 0.9305     |

  ### Fairness

  |            | **P3_0.1**   | **P3_1.0**   | **P6_0.1**  | **P6_1.0**   | **P9_0.1**   | **P9_1.0**   |
  | ---------- | ------------ | ------------ | ----------- | ------------ | ------------ | ------------ |
  | **Fedavg** | -0.50911     | -0.50911     | 0.577507    | 0.577507     | 0.103275     | 0.103275     |
  | **DSSGD**  | 0.75956      | 0.819994     | 0.730391    | 0.580944     | -0.75699     | 0.815766     |
  | **CFFL**   | **0.999967** | **0.998123** | **0.99969** | **0.995025** | 0.996542     | 0.993368     |
  | **CFFL_P** | 0.999755     | 0.997853     | 0.997121    | 0.994356     | **0.996783** | **0.997445** |

  ## Imbalance class

  ### Accuracy

  |                | **P3_0.1** | **P3_1.0** | **P6_0.1** | **P6_1.0** | **P9_0.1** | **P9_1.0** |
  | -------------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
  | **Fedavg**     | 0.8299     | 0.8299     | 0.789      | 0.7925     | 0.7467     | 0.7467     |
  | **DSSGD**      | 0.7912     | 0.8109     | 0.7505     | 0.7611     | 0.6527     | 0.6999     |
  | **Standalone** | 0.8572     | 0.8572     | 0.8694     | 0.8679     | 0.8619     | 0.8619     |
  | **CFFL**       | **0.8704** | **0.87**   | 0.8945     | **0.9048** | **0.9087** | 0.9157     |
  | **CFFL_P**     | 0.8703     | 0.8687     | **0.8946** | 0.8952     | 0.9031     | **0.9159** |

  ### Fairness

  |            | **P3_0.1**   | **P3_1.0**   | **P6_0.1**   | **P6_1.0**   | **P9_0.1**  | **P9_1.0**   |
  | ---------- | ------------ | ------------ | ------------ | ------------ | ----------- | ------------ |
  | **Fedavg** | -0.59065     | -0.59065     | -0.38795     | -0.58231     | -0.43987    | -0.43987     |
  | **DSSGD**  | -0.01423     | -0.07831     | -0.3134      | 0.033506     | -0.88091    | -0.19376     |
  | **CFFL**   | 0.988761     | 0.952534     | 0.948923     | 0.949149     | 0.928042    | 0.968656     |
  | **CFFL_P** | **0.999493** | **0.987242** | **0.998739** | **0.994166** | **0.96821** | **0.974728** |
